<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prayer Times – Gosheim, Germany</title>
<style>
  /* Root colors */
  :root {
    --bg: #0b0f14;
    --card: #111722;
    --text: #e6edf3;
    --muted: #9fb0c0;
    --accent: #3aaaff;
  }

  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: var(--bg);
    color: var(--text);
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1rem;
  }

  h1 {
    margin-bottom: 0.5rem;
    text-align: center;
  }

  .card {
    background-color: var(--card);
    border-radius: 1rem;
    padding: 1rem;
    width: 100%;
    max-width: 400px;
    margin-bottom: 1rem;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  }

  .prayer-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .prayer-item {
    display: flex;
    justify-content: space-between;
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    background-color: #1a1f2b;
  }

  .prayer-item.next {
    background-color: var(--accent);
    color: #fff;
    font-weight: bold;
  }

  .countdown {
    text-align: center;
    font-size: 1.2rem;
    margin-top: 0.5rem;
    color: var(--accent);
  }

  .footer {
    font-size: 0.75rem;
    color: var(--muted);
    margin-top: 1rem;
    text-align: center;
  }
</style>
</head>
<body>

<h1>Prayer Times – Gosheim, Germany</h1>

<div class="card">
  <div class="prayer-list">
    <div class="prayer-item" id="fajr-row">Fajr <span id="fajr">—</span></div>
    <div class="prayer-item" id="dhuhr-row">Dhuhr <span id="dhuhr">—</span></div>
    <div class="prayer-item" id="asr-row">Asr <span id="asr">—</span></div>
    <div class="prayer-item" id="maghrib-row">Maghrib <span id="maghrib">—</span></div>
    <div class="prayer-item" id="isha-row">Isha <span id="isha">—</span></div>
  </div>
  <div class="countdown" id="next-prayer">Next prayer in —</div>
</div>

<div class="footer">
  Powered by AlAdhan API • Method: Muslim World League • School: Hanafi
</div>

<script>
const city = "Gosheim";
const country = "Germany";
const method = 3; // Muslim World League

const prayerIds = ["fajr", "dhuhr", "asr", "maghrib", "isha"];
const prayerRows = {
  fajr: document.getElementById("fajr-row"),
  dhuhr: document.getElementById("dhuhr-row"),
  asr: document.getElementById("asr-row"),
  maghrib: document.getElementById("maghrib-row"),
  isha: document.getElementById("isha-row"),
};

function fetchPrayerTimes() {
  fetch(`https://api.aladhan.com/v1/timingsByCity?city=${city}&country=${country}&method=${method}`)
    .then(res => res.json())
    .then(data => {
      const timings = data.data.timings;
      prayerIds.forEach(prayer => {
        document.getElementById(prayer).textContent = timings[prayer.charAt(0).toUpperCase() + prayer.slice(1)];
      });
      updateNextPrayer(timings);
    });
}

function updateNextPrayer(timings) {
  const now = new Date();
  const today = now.toISOString().split('T')[0]; // yyyy-mm-dd

  let nextPrayer = null;
  let nextTime = null;

  for (let prayer of prayerIds) {
    const timeStr = `${today}T${timings[prayer.charAt(0).toUpperCase() + prayer.slice(1)]}:00`;
    const prayerTime = new Date(timeStr);
    if (prayerTime > now) {
      nextPrayer = prayer;
      nextTime = prayerTime;
      break;
    }
  }

  if (!nextPrayer) {
    // If all prayers passed, take tomorrow Fajr
    const tomorrow = new Date(now);
    tomorrow.setDate(now.getDate() + 1);
    const tomorrowDate = tomorrow.toISOString().split('T')[0];
    nextPrayer = "fajr";
    nextTime = new Date(`${tomorrowDate}T${timings.Fajr}:00`);
  }

  // Highlight next prayer
  prayerIds.forEach(prayer => {
    prayerRows[prayer].classList.remove("next");
  });
  prayerRows[nextPrayer].classList.add("next");

  // Countdown
  const countdownEl = document.getElementById("next-prayer");
  const diffMs = nextTime - now;
  const hours = Math.floor(diffMs / 1000 / 60 / 60);
  const minutes = Math.floor((diffMs / 1000 / 60) % 60);
  const seconds = Math.floor((diffMs / 1000) % 60);
  countdownEl.textContent = `Next prayer (${nextPrayer.charAt(0).toUpperCase() + nextPrayer.slice(1)}) in ${hours}h ${minutes}m ${seconds}s`;
}

// Initial fetch and every minute update
fetchPrayerTimes();
setInterval(fetchPrayerTimes, 60000);
</script>

</body>
</html>
